# Arquitetura do Sistema

Este documento descreve a arquitetura do sistema, incluindo as tecnologias, plataformas e decis√µes de design utilizadas na constru√ß√£o do projeto. A arquitetura √© um elemento cr√≠tico para garantir a escalabilidade, manutenibilidade e desempenho do sistema, al√©m de facilitar a integra√ß√£o e a implementa√ß√£o cont√≠nuas.

## Tecnologias e Plataformas

Definir as tecnologias e plataformas utilizadas no projeto √© essencial para alcan√ßar a efici√™ncia e seguran√ßa esperadas. A escolha cuidadosa desses elementos tamb√©m influencia o desenvolvimento, opera√ß√£o e crescimento futuro da solu√ß√£o, adaptando-a √†s demandas do usu√°rio e ao contexto de mercado.

### _Front-end_

üèóÔ∏è Em breve. Adicionar informa√ß√µes mais detalhadas sobre o _front-end_

### _Back-end_

A arquitetura do back-end foi desenhada para suportar a l√≥gica de neg√≥cio e as integra√ß√µes com servi√ßos externos, incluindo armazenamento de dados e autentica√ß√£o de usu√°rios.

A plataforma AWS foi escolhida para o ambiente de produ√ß√£o devido √† sua alta disponibilidade, seguran√ßa e vasto ecossistema de servi√ßos que suportam desenvolvimento √°gil e escal√°vel. Al√©m disso, a AWS oferece ferramentas integradas para monitoramento e otimiza√ß√£o de recursos, facilitando o controle de custos e a gest√£o da infraestrutura.

O uso de AWS Lambda permite uma arquitetura baseada em fun√ß√µes, com a vantagem de escalar automaticamente e cobrar apenas pelo tempo de execu√ß√£o necess√°rio. Essa abordagem serverless √© ideal para nosso projeto, pois elimina a necessidade de gerenciar servidores, reduzindo a complexidade de opera√ß√µes e garantindo a execu√ß√£o de tarefas de maneira eficiente e econ√¥mica.

Para agilidade no desenvolvimento inicial, as fun√ß√µes ser√£o prototipadas em Python, devido √† facilidade de escrita e √† vasta comunidade de bibliotecas dispon√≠veis. No entanto, com o objetivo de otimizar o desempenho e reduzir a lat√™ncia das fun√ß√µes no longo prazo, o c√≥digo ser√° gradualmente convertido para Go, uma linguagem conhecida pela rapidez de execu√ß√£o e efici√™ncia em recursos.

## Arquitetura

A arquitetura √© baseada em uma estrutura modular e escal√°vel, utilizando AWS Lambda para gerenciar a l√≥gica de backend de maneira serverless e DynamoDB como banco de dados para armazenar os dados do usu√°rio e pedidos. Esse modelo serverless permite escalar automaticamente as fun√ß√µes conforme a demanda, otimizando os custos e garantindo que o sistema funcione de maneira eficiente e confi√°vel.

√â v√°lido ressaltar que essa √© uma vers√£o 1 da arquitetura, ao longo do processo de implementa√ß√£o e desenvolvimento da aplica√ß√£o, ser√° necess√°rio a refatora√ß√£o dessa arquitetura visando contemplar tudo que foi feito para garantir o funcionamento do sistema.

![Arquitetura do sistema v1](<../static/img/arquitetura_do_sistema_v1.png>)

### Fluxo do Usu√°rio

1. **Homepage:** O usu√°rio acessa a p√°gina inicial, onde decide se quer se registrar (caso n√£o tenha login na plataforma) ou fazer login.
2. **Cadastro e login:** Se o usu√°rio n√£o tiver uma conta, ele √© redirecionado para a tela de cadastro. Caso contr√°rio, √© direcionado para a tela de login.
    - A lambda **create_user** √© chamada para criar um novo usu√°rio, inserindo os dados no DynamoDB.
    - A lambda **get_user** √© respons√°vel por verificar o login do usu√°rio, consultando o banco de dados para autentica√ß√£o.
3. **Funcionalidades de pedidos (orders)**
    - Ap√≥s o login, o usu√°rio pode acessar as funcionalidades de consulta e cria√ß√£o de pedidos.
    - Na tela para consultar pedidos em andamento e na tela para consultar hist√≥rico de pedidos, a fun√ß√£o lambda get_orders busca no DynamoDB as informa√ß√µes de pedidos do usu√°rio.
    - Para criar novas etiquetas de pedidos na tela de cria√ß√£o de etiquetas, a fun√ß√£o lambda create_order √© chamada. Ela grava as informa√ß√µes de pedido no banco de dados e retorna uma resposta confirmando a cria√ß√£o.

### Lambdas

Aqui est√° o registro das lambdas desenvolvidas para a aplica√ß√£o.

- **create_user:** Respons√°vel pela inser√ß√£o de novos usu√°rios no DynamoDB durante o cadastro.
- **get_user:** Executa uma consulta para verificar e autenticar os usu√°rios que fazem login.
- **get_orders:** Consulta pedidos espec√≠ficos do usu√°rio com base no user_id e status, retornando a lista de pedidos.
- **create_order:** Insere novos pedidos no banco de dados, permitindo que o usu√°rio crie etiquetas personalizadas para cada pedido.

### Estrutura do DynamoDB

Para consultar a arquitetura do banco de dados, v√° para a se√ß√£o **6. Modelagem Banco de Dados**.

üèóÔ∏è Em breve. Aqui ter√° o esquema utilizado para a cria√ß√£o das etiquetas dentro do DynamoDB.

## Integra√ß√£o com Servi√ßos Externos

Uma parte essencial desse sistema √© a capacidade de realizar pagamentos, pois facilita a convers√£o dos pedidos em transa√ß√µes financeiras. Para isso, √© necess√°ria uma integra√ß√£o com servi√ßos de pagamento externos, que incluem gateways e processadores de pagamento, garantindo que as transa√ß√µes sejam realizadas de maneira segura e conforme os padr√µes da ind√∫stria.

### A l√≥gica dos sistemas de pagamento

1. Componentes de um sistema de pagamento
- **Gateway de Pagamento:** √© o servi√ßo que atua como intermedi√°rio entre o e-commerce e a rede de pagamento, criptografando e transmitindo os dados de pagamento.
- **Processador de Pagamento:** processa a transa√ß√£o e coordena com bancos e bandeiras de cart√£o de cr√©dito/d√©bito.
- **Institui√ß√µes Financeiras:** como bancos e bandeiras de cart√µes (Visa, Mastercard, etc.) que aprovam ou recusam a transa√ß√£o.

2. Fluxo b√°sico de uma transa√ß√£o
1. **Checkout:** o cliente seleciona o m√©todo de pagamento e insere suas informa√ß√µes.
2. **Autentica√ß√£o:** os dados s√£o enviados ao gateway de pagamento, que os autentica com o processador.
3. **Autoriza√ß√£o:** o processador comunica-se com o banco emissor para verificar se a transa√ß√£o pode ser aprovada.
4. **Confirma√ß√£o e Captura:** se aprovada, a transa√ß√£o √© capturada e o valor √© transferido.

3. Partes necess√°rias para a integra√ß√£o
- **API de Pagamento:** usando APIs de provedores como Stripe, PayPal, ou PagSeguro, o backend faz requisi√ß√µes para realizar, autorizar, e capturar pagamentos.
- **Webhook:** um servi√ßo externo envia notifica√ß√µes ao backend do e-commerce para atualizar o status do pagamento, como confirma√ß√£o de pagamento.
- **Tokens e Criptografia:** para garantir seguran√ßa, muitas integra√ß√µes utilizam tokens (em vez de armazenar diretamente os dados dos cart√µes) e implementam criptografia nos dados enviados.
